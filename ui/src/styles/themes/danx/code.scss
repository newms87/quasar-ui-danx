// Code Viewer Theme
// Supports dark (default) and light themes with syntax highlighting for JSON/YAML

.dx-code-viewer {
  width: 100%;
  height: 100%;

  // ==========================================
  // Collapsible mode
  // ==========================================
  &.is-collapsed {
    height: auto;
  }

  // Collapsed view - inline preview
  .code-collapsed {
    background-color: #1e1e1e;
    border-radius: 0.375rem;
    padding: 0.5rem 0.75rem;
    font-family: 'Consolas', 'Monaco', 'Menlo', 'Ubuntu Mono', 'source-code-pro', monospace;
    font-size: 0.875rem;
    transition: background-color 0.15s ease;

    &:hover {
      background-color: #252526;
    }

    .code-collapsed-preview {
      color: #d4d4d4;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }

  // Collapse toggle button in expanded view
  .collapse-toggle {
    transition: color 0.15s ease;
  }

  // Clickable header area to collapse when expanded
  .collapse-header {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1.5rem;
    cursor: pointer;
    z-index: 5;
  }

  // Code content area - the main display
  .code-content {
    // When collapsible, add padding for the collapse toggle button
    &.is-collapsible {
      padding-top: 1rem;
      padding-left: 1rem;
    }

    background-color: #1e1e1e;
    color: #d4d4d4;
    width: 100%;
    min-height: 0;
    font-family: 'Consolas', 'Monaco', 'Menlo', 'Ubuntu Mono', 'source-code-pro', monospace;
    font-size: 0.875rem;
    line-height: 1.6;
    border-radius: 0.375rem 0.375rem 0 0;
    padding: 1rem;
    overflow: auto;
    margin: 0;
    box-sizing: border-box;

    code {
      white-space: pre-wrap;
      word-break: break-word;
      background: transparent;
      color: inherit;
    }
  }

  // Footer area
  .code-footer {
    background-color: #252526;
    border-radius: 0 0 0.375rem 0.375rem;
    padding: 0.25rem 0.5rem;
    transition: background-color 0.2s ease;

    &.has-error {
      background-color: #5a1d1d;
      border-top: 1px solid #be1100;
    }
  }

  // Language badge
  .language-badge {
    background-color: #333333;
    color: #808080;
    padding: 0.25rem 0.5rem;
    font-size: 0.7em;
    text-transform: uppercase;
  }

  // ==========================================
  // Syntax highlighting classes
  // ==========================================

  // Keys (property names) - Light blue
  .syntax-key {
    color: #9cdcfe;
  }

  // Strings - Soft green
  .syntax-string {
    color: #9ae6b4;
  }

  // Numbers - Orange/salmon
  .syntax-number {
    color: #ce9178;
  }

  // Booleans - Blue
  .syntax-boolean {
    color: #569cd6;
  }

  // Null - Blue
  .syntax-null {
    color: #569cd6;
  }

  // Punctuation - Gray
  .syntax-punctuation {
    color: #808080;
  }

  // Comments - Muted green
  .syntax-comment {
    color: #6a9955;
  }

  // CSS/HTML specific
  .syntax-selector {
    color: #d7ba7d; // Gold/yellow
  }

  .syntax-property {
    color: #9cdcfe; // Light blue (same as key)
  }

  .syntax-value {
    color: #ce9178; // Orange (same as number)
  }

  .syntax-at-rule {
    color: #c586c0; // Purple/magenta
  }

  // JavaScript specific
  .syntax-keyword {
    color: #569cd6; // Blue
  }

  .syntax-operator {
    color: #d4d4d4; // Gray/white
  }

  .syntax-regex {
    color: #d16969; // Red
  }

  .syntax-template {
    color: #ce9178; // Orange (same as string/number)
  }

  // HTML specific
  .syntax-tag {
    color: #569cd6; // Blue
  }

  .syntax-attribute {
    color: #9cdcfe; // Light blue
  }

  .syntax-doctype {
    color: #808080; // Gray
  }


  // ==========================================
  // Editable mode (contenteditable)
  // ==========================================
  .code-content.is-editable {
    cursor: text;
    outline: none;
    border: 2px solid transparent;
    transition: border-color 0.2s ease;

    &:focus {
      border-color: rgba(86, 156, 214, 0.6);
    }

    &:hover:not(:focus) {
      border-color: rgba(86, 156, 214, 0.3);
    }

    // Caret color
    caret-color: #d4d4d4;
  }

  // ==========================================
  // LIGHT THEME VARIANT
  // ==========================================
  &.theme-light {
    .code-collapsed {
      background-color: #f5f5f5;

      &:hover {
        background-color: #ebebeb;
      }

      .code-collapsed-preview {
        color: #333333;
      }
    }

    .code-content {
      background-color: #f8fafc;
      color: #1e293b;
      border: 1px solid #e2e8f0;
    }

    .code-footer {
      background-color: #f1f5f9;
      border-top: 1px solid #e2e8f0;

      &.has-error {
        background-color: #fee2e2;
        border-top: 1px solid #ef4444;
      }
    }

    .language-badge {
      background-color: #e2e8f0;
      color: #64748b;
    }

    // Light theme syntax highlighting
    .syntax-key {
      color: #0369a1;
    }

    .syntax-string {
      color: #15803d;
    }

    .syntax-number {
      color: #c2410c;
    }

    .syntax-boolean {
      color: #7c3aed;
    }

    .syntax-null {
      color: #7c3aed;
    }

    .syntax-punctuation {
      color: #64748b;
    }

    // Light theme - Comments
    .syntax-comment {
      color: #6a9955;
    }

    // Light theme - CSS/HTML specific
    .syntax-selector {
      color: #b45309; // Amber/brown
    }

    .syntax-property {
      color: #0369a1; // Blue (same as key)
    }

    .syntax-value {
      color: #c2410c; // Orange (same as number)
    }

    .syntax-at-rule {
      color: #7c3aed; // Purple
    }

    // Light theme - JavaScript specific
    .syntax-keyword {
      color: #0369a1; // Blue
    }

    .syntax-operator {
      color: #64748b; // Gray
    }

    .syntax-regex {
      color: #be123c; // Red/rose
    }

    .syntax-template {
      color: #c2410c; // Orange
    }

    // Light theme - HTML specific
    .syntax-tag {
      color: #0369a1; // Blue
    }

    .syntax-attribute {
      color: #0891b2; // Cyan
    }

    .syntax-doctype {
      color: #64748b; // Gray
    }

    .code-content.is-editable {
      caret-color: #1e293b;

      &:focus {
        border-color: rgba(14, 165, 233, 0.6);
      }

      &:hover:not(:focus) {
        border-color: rgba(14, 165, 233, 0.3);
      }
    }

    // Light theme - Language badge component overrides
    .dx-language-badge-container {
      // Container needs no background changes
    }

    .dx-language-badge {
      background: rgba(0, 0, 0, 0.08);
      color: #64748b;

      &.is-active {
        background: rgba(0, 0, 0, 0.12);
      }
    }

    .dx-language-option {
      background: rgba(0, 0, 0, 0.06);
      color: #64748b;
      border-right: 1px solid rgba(0, 0, 0, 0.1);

      &:hover {
        background: rgba(0, 0, 0, 0.12);
        color: #1e293b;
      }
    }

    .dx-language-search-trigger {
      // Inherits from dx-language-option
    }

    .dx-language-search-panel {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .dx-language-search-input {
      background: #f1f5f9;
      border-bottom: 1px solid #e2e8f0;
      color: #1e293b;

      &::placeholder {
        color: #94a3b8;
      }

      &:focus {
        background: #e2e8f0;
      }
    }

    .dx-language-search-list {
      &::-webkit-scrollbar-track {
        background: #f1f5f9;
      }

      &::-webkit-scrollbar-thumb {
        background: #cbd5e1;

        &:hover {
          background: #94a3b8;
        }
      }
    }

    .dx-language-search-item {
      color: #64748b;

      &:hover,
      &.is-selected {
        background: #e2e8f0;
        color: #1e293b;
      }
    }

    .dx-language-search-empty {
      color: #94a3b8;
    }
  }
}
