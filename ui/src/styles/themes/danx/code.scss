// Code Viewer Theme
// Supports dark (default) and light themes with syntax highlighting for JSON/YAML

.dx-code-viewer {
  width: 100%;
  height: 100%;

  // ==========================================
  // Collapsible mode
  // ==========================================
  &.is-collapsed {
    height: auto;
  }

  // Collapsed view - inline preview
  .code-collapsed {
    background-color: #1e1e1e;
    border-radius: 0.375rem;
    padding: 0.5rem 0.75rem;
    font-family: 'Consolas', 'Monaco', 'Menlo', 'Ubuntu Mono', 'source-code-pro', monospace;
    font-size: 0.875rem;
    transition: background-color 0.15s ease;

    &:hover {
      background-color: #252526;
    }

    .code-collapsed-preview {
      color: #d4d4d4;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }

  // Collapse toggle button in expanded view
  .collapse-toggle {
    transition: color 0.15s ease;
  }

  // Clickable header area to collapse when expanded
  .collapse-header {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1.5rem;
    cursor: pointer;
    z-index: 5;
  }

  // Code content area - the main display
  .code-content {
    // When collapsible, add padding for the collapse toggle button
    &.is-collapsible {
      padding-top: 1rem;
      padding-left: 1rem;
    }

    background-color: #1e1e1e;
    color: #d4d4d4;
    width: 100%;
    min-height: 0;
    font-family: 'Consolas', 'Monaco', 'Menlo', 'Ubuntu Mono', 'source-code-pro', monospace;
    font-size: 0.875rem;
    line-height: 1.6;
    border-radius: 0.375rem 0.375rem 0 0;
    padding: 1rem;
    overflow: auto;
    margin: 0;
    box-sizing: border-box;

    code {
      white-space: pre-wrap;
      word-break: break-word;
      background: transparent;
      color: inherit;
    }
  }

  // Footer area
  .code-footer {
    background-color: #252526;
    border-radius: 0 0 0.375rem 0.375rem;
    padding: 0.25rem 0.5rem;
    transition: background-color 0.2s ease;

    &.has-error {
      background-color: #5a1d1d;
      border-top: 1px solid #be1100;
    }
  }

  // Language badge
  .language-badge {
    background-color: #333333;
    color: #808080;
    padding: 0.25rem 0.5rem;
    font-size: 0.7em;
    text-transform: uppercase;
  }

  // ==========================================
  // Syntax highlighting classes
  // ==========================================

  // Keys (property names) - Light blue
  .syntax-key {
    color: #9cdcfe;
  }

  // Strings - Soft green
  .syntax-string {
    color: #9ae6b4;
  }

  // Numbers - Orange/salmon
  .syntax-number {
    color: #ce9178;
  }

  // Booleans - Blue
  .syntax-boolean {
    color: #569cd6;
  }

  // Null - Blue
  .syntax-null {
    color: #569cd6;
  }

  // Punctuation - Gray
  .syntax-punctuation {
    color: #808080;
  }


  // ==========================================
  // Editable mode (contenteditable)
  // ==========================================
  .code-content.is-editable {
    cursor: text;
    outline: none;
    border: 2px solid transparent;
    transition: border-color 0.2s ease;

    &:focus {
      border-color: rgba(86, 156, 214, 0.6);
    }

    &:hover:not(:focus) {
      border-color: rgba(86, 156, 214, 0.3);
    }

    // Caret color
    caret-color: #d4d4d4;
  }

  // ==========================================
  // LIGHT THEME VARIANT
  // ==========================================
  &.theme-light {
    .code-collapsed {
      background-color: #f5f5f5;

      &:hover {
        background-color: #ebebeb;
      }

      .code-collapsed-preview {
        color: #333333;
      }
    }

    .code-content {
      background-color: #f8fafc;
      color: #1e293b;
      border: 1px solid #e2e8f0;
    }

    .code-footer {
      background-color: #f1f5f9;
      border-top: 1px solid #e2e8f0;

      &.has-error {
        background-color: #fee2e2;
        border-top: 1px solid #ef4444;
      }
    }

    .language-badge {
      background-color: #e2e8f0;
      color: #64748b;
    }

    // Light theme syntax highlighting
    .syntax-key {
      color: #0369a1;
    }

    .syntax-string {
      color: #15803d;
    }

    .syntax-number {
      color: #c2410c;
    }

    .syntax-boolean {
      color: #7c3aed;
    }

    .syntax-null {
      color: #7c3aed;
    }

    .syntax-punctuation {
      color: #64748b;
    }

    .code-content.is-editable {
      caret-color: #1e293b;

      &:focus {
        border-color: rgba(14, 165, 233, 0.6);
      }

      &:hover:not(:focus) {
        border-color: rgba(14, 165, 233, 0.3);
      }
    }
  }
}
